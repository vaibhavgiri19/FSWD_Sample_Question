import React, { useState } from 'react';

const initialItems = [
  { id: 1, name: 'Milk' },
  { id: 2, name: 'Eggs' },
  { id: 3, name: 'Bread' },
];

function App() {
  const [items, setItems] = useState(initialItems);
  const [editingItem, setEditingItem] = useState(null);
  const [editName, setEditName] = useState('');
  const [itemToDelete, setItemToDelete] = useState(null);

  // ✅ Handle Edit button click
  const handleEditClick = (item) => {
    setEditingItem(item);
    setEditName(item.name);
  };

  // ✅ Save edited item
  const handleSave = () => {
    if (!editName.trim()) return; // Validation: cannot save empty name

    const updatedItems = items.map((i) =>
      i.id === editingItem.id ? { ...i, name: editName } : i
    );

    setItems(updatedItems);
    setEditingItem(null);
    setEditName('');
  };

  // ✅ Cancel Edit
  const handleCancelEdit = () => {
    setEditingItem(null);
    setEditName('');
  };

  // ✅ Delete click → open confirmation box
  const handleDeleteClick = (item) => {
    setItemToDelete(item);
  };

  // ✅ Confirm delete
  const handleConfirmDelete = () => {
    const updatedItems = items.filter((i) => i.id !== itemToDelete.id);
    setItems(updatedItems);
    setItemToDelete(null);
  };

  // ✅ Cancel delete
  const handleCancelDelete = () => {
    setItemToDelete(null);
  };

  return (
    <div>
      <h1>Shopping List</h1>

      {items.map((item) => (
        <div
          key={item.id}
          style={{
            border: '1px solid black',
            margin: '8px',
            padding: '8px',
          }}
        >
          {editingItem && editingItem.id === item.id ? (
            <div>
              <input
                type="text"
                value={editName}
                onChange={(e) => setEditName(e.target.value)}
              />
              <button onClick={handleSave}>Save</button>
              <button onClick={handleCancelEdit}>Cancel</button>
            </div>
          ) : (
            <div>
              <p>{item.name}</p>
              <button onClick={() => handleEditClick(item)}>Edit</button>
              <button onClick={() => handleDeleteClick(item)}>Delete</button>
            </div>
          )}
        </div>
      ))}

      {itemToDelete && (
        <div
          style={{
            border: '1px solid red',
            padding: '8px',
            marginTop: '16px',
          }}
        >
          <p>Delete "{itemToDelete.name}"?</p>
          <button onClick={handleConfirmDelete}>Confirm</button>
          <button onClick={handleCancelDelete} style={{ marginLeft: '8px' }}>
            Cancel
          </button>
        </div>
      )}
    </div>
  );
}

export default App;
